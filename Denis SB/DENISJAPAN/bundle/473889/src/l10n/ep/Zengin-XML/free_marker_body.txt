<#-- format specific processing -->
<#function getAccountType acctType>
    <#assign value = "0">
		<#if acctType == "Ordinary">
			<#assign value = "1" >
		<#elseif acctType == "Check">
			<#assign value = "2" >
		</#if>
    <#return value>
</#function>

<#-- template building -->

#OUTPUT START#
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Document xmlns="urn:iso:std:iso:20022:tech:xsd:pain.001.001.03">
    <CstmrCdtTrfInitn>
        <GrpHdr>
            <MsgId>${pfa.id}</MsgId>
            <CreDtTm>${pfa.custrecord_2663_file_creation_timestamp?date?string("yyyy-MM-dd")}T${pfa.custrecord_2663_file_creation_timestamp?time?string("HH:mm:ss")}</CreDtTm>
            <NbOfTxs>${payments?size?c}</NbOfTxs>
            <InitgPty></InitgPty>
        </GrpHdr>
        <PmtInf>
            <PmtInfId>${pfa.id}</PmtInfId>
            <PmtMtd>TRF</PmtMtd>
            <NbOfTxs>${payments?size?c}</NbOfTxs>
            <CtrlSum>${formatAmount(computeTotalAmount(payments),"truncDec")}</CtrlSum>
            <PmtTpInf>
                <CtgyPurp>
                    <Cd>OTHR</Cd>
                </CtgyPurp>
            </PmtTpInf>
            <ReqdExctnDt>${pfa.custrecord_2663_process_date?string("yyyy-MM-dd")}</ReqdExctnDt>
            <Dbtr>
                <Id>
                    <OrgId>
                        <Othr>
                            <Id>${setPadding(cbank.custpage_eft_custrecord_2663_processor_code,"left","0",10)}</Id>
                            <SchmeNm>
                                <Cd>BANK</Cd>
                            </SchmeNm>
                        </Othr>
                        <Othr>
                            <Id></Id>
                            <SchmeNm>
                                <Cd></Cd>
                            </SchmeNm>
                        </Othr>
                    </OrgId>
                </Id>
            </Dbtr>
            <DbtrAcct>
                <Id>
                    <Othr>
                        <Id>${setPadding(cbank.custpage_eft_custrecord_2663_acct_num,"left","0",7)}</Id>
                    </Othr>
                </Id>
                <Tp>
                    <Prtry>${getAccountType(cbank.custpage_eft_custrecord_2663_bank_acct_type2)}</Prtry>
                </Tp>
            </DbtrAcct>
            <DbtrAgt>
                <FinInstnId>
                    <ClrSysMmbId>
                        <ClrSysId>
                            <Cd>JPZGN</Cd>
                        </ClrSysId>
                        <MmbId>${cbank.custpage_eft_custrecord_2663_bank_num}</MmbId>
                    </ClrSysMmbId>
                    <Nm>${cbank.custpage_eft_custrecord_2663_bank_name}</Nm>
                </FinInstnId>
                <BrnchId>
                    <Id>${cbank.custpage_eft_custrecord_2663_branch_num}</Id>
                    <Nm>${cbank.custpage_eft_custrecord_2663_branch_name}</Nm>
                </BrnchId>
            </DbtrAgt>
            <UltmtDbtr>
                <Nm>${cbank.custrecord_2663_legal_name}</Nm>
            </UltmtDbtr>
            <#list payments as payment>
                <#assign ebank = ebanks[payment_index]>
            <CdtTrfTxInf>
                <PmtId>
                    <EndToEndId>${payment.tranid}</EndToEndId>
                </PmtId>
                <Amt>
                    <InstdAmt Ccy="JPY">${formatAmount(getAmount(payment),"truncDec")}</InstdAmt>
                </Amt>
                <CdtrAgt>
                    <FinInstnId>
                        <ClrSysMmbId>
                            <MmbId>${ebank.custrecord_2663_entity_bank_no}</MmbId>
                        </ClrSysMmbId>
                        <Nm>${ebank.custrecord_2663_entity_bank_name}</Nm>
                        <Othr>
                            <Id></Id>
                        </Othr>
                    </FinInstnId>
                    <BrnchId>
                        <Id>${ebank.custrecord_2663_entity_branch_no}</Id>
                        <Nm>${ebank.custrecord_2663_entity_branch_name}</Nm>
                    </BrnchId>
                </CdtrAgt>
                <Cdtr>
                    <Nm>${ebank.custrecord_2663_entity_acct_name}</Nm>
                    <Id>
                        <OrgId>
                            <Othr>
                                <Id></Id>
                                <SchmeNm>
                                    <Cd></Cd>
                                </SchmeNm>
                            </Othr>
                            <Othr>
                                <Id></Id>
                                <SchmeNm>
                                    <Prtry></Prtry>
                                </SchmeNm>
                            </Othr>
                            <Othr>
                                <Id></Id>
                                <SchmeNm>
                                    <Prtry></Prtry>
                                </SchmeNm>
                            </Othr>
                        </OrgId>
                    </Id>
                </Cdtr>
                <CdtrAcct>
                    <Id>
                        <Othr>
                            <Id>${setPadding(ebank.custrecord_2663_entity_acct_no,"left","0",7)}</Id>
                        </Othr>
                    </Id>
                    <Tp>
                        <Prtry>${getAccountType(ebank.custrecord_2663_acct_type)}</Prtry>
                    </Tp>
                </CdtrAcct>
                <InstrForCdtrAgt>
                    <InstrInf>7</InstrInf>
                </InstrForCdtrAgt>
                <InstrForDbtrAgt></InstrForDbtrAgt>
                <Purp>
                    <Prtry>1</Prtry>
                </Purp>
                <RmtInf>
                    <Ustrd></Ustrd>
                </RmtInf>
            </CdtTrfTxInf>
            </#list>
        </PmtInf>
    </CstmrCdtTrfInitn>
</Document>
#OUTPUT END#